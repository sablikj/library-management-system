@model LibraryManagement.Models.Entity.Book

@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container d-flex justify-content-center" id="logreg-forms" style="border-radius: .75rem">
    <div class="bg-white px-4 w-75 shadow" style="border-radius: .75rem">
        <h1 class="pt-2 d-flex justify-content-between align-items-center">
            @Model.Name
            <span>                
                <a style="margin-bottom:5px;" class="btn btn-sm btn-primary text-white" asp-action="Index"><i class="bi bi-arrow-left"></i></a>
            </span>
        </h1>    
        <div class="@ViewBag.AlertClass fade" role="alert">
            <h4 class="text-center">
                <span class="glyphicon glyphicon-ok-sign"></span>
                @ViewBag.Message
            </h4>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <hr />
        <dl class="row">
            <!--Image-->
            <div class="col w-25">
                <div class="col w-50 largepic mx-auto d-block">
                    @{
                        var base64 = Convert.ToBase64String(Model.ImageContent);
                        var imgSrc = String.Format("data:image/gif;base64,{0}", base64);
                    }
                    <a asp-controller="Book" asp-action="imageEdit" asp-route-id="@Model.Id">
                        <img class="largepic__image" src="@imgSrc" style="float:middle" />
                        <div class="largepic__content">
                            <span class="largepic__icon"><i class="bi bi-pencil"></i></span>
                            <span class="largepic__text">Edit</span>
                        </div>
                    </a>
                </div>
            </div>
            <!--Info-->
            <div class="col w-75">
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.Author)
                    </dt>
                    <dd class="col w-25">
                        @Html.DisplayFor(model => model.Author)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.Pages)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.Pages)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.Year)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.Year)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.ISBN)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.ISBN)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.ImageAlt)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.ImageAlt)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.Quantity)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.Quantity)
                    </dd>
                </div>
                <div class="row">
                    <dt class="col w-25">
                        @Html.DisplayNameFor(model => model.Available)
                    </dt>
                    <dd class="col w-75">
                        @Html.DisplayFor(model => model.Available)
                    </dd>
                </div>
                <!--Buttons-->
                <div class="row mt-10 w-100">
                    @if(User.Identity.IsAuthenticated == true)
                    {
                        if(Model.Available > 0)
                        {
                            // Display borrow button only if user is logged in and book is available
                            <a style="margin-bottom:5px;" class="btn btn-sm btn-primary text-white w-25 mx-auto d-block" asp-controller="Customer" asp-action="Borrow"><i class="bi bi-book me-2"></i>    Borrow</a>
                        }
                        else
                        {
                            // Book is out of stock
                            <a style="margin-bottom:5px;" class="btn btn-sm btn-secondary disabled w-50 mx-auto d-block"><i class="bi bi-x-circle me-2"></i>    Out of stock</a>
                        }                        
                    }
                </div>
            </div>
        </dl>
        <hr />
        <dl class="row mb-7 px-4 py-2">            
            @Html.DisplayFor(model => model.Description)
        </dl>
    </div>    
</div>
<div class="container d-flex justify-content-center my-7" id="logreg-forms" style="border-radius: .75rem">
    <div class="bg-white px-4 w-75 shadow" style="border-radius: .75rem">
        <h3 class="pt-2 d-flex justify-content-between align-items-center">
            More books from this author
        </h3>
        <hr />
        <dl class="row">
            <!--TODO: Add list of books from same author-->
        </dl>
    </div>
</div>
